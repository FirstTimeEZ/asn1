import * as asn1 from "../asn1.js"

let cert2 = `-----BEGIN CERTIFICATE-----
MIIDtjCCAzugAwIBAgISK1rvUtJhWROMvjmPX10Woba9MAoGCCqGSM49BAMDMFIx
CzAJBgNVBAYTAlVTMSAwHgYDVQQKExcoU1RBR0lORykgTGV0J3MgRW5jcnlwdDEh
MB8GA1UEAxMYKFNUQUdJTkcpIFBzZXVkbyBQbHVtIEU1MB4XDTI0MTIxMzA3MzA1
NloXDTI1MDMxMzA3MzA1NVowGDEWMBQGA1UEAxMNd3d3LnNzbC5ib2F0czBZMBMG
ByqGSM49AgEGCCqGSM49AwEHA0IABB9aKqx/UjiKE9Ar8obaLS5cLRzR+ajUbAh6
b0C8c6FbtoDtMObswuMRU5j5QxQ+mI83JAzEGEi/bhlgbqbRE4mjggIpMIICJTAO
BgNVHQ8BAf8EBAMCB4AwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMAwG
A1UdEwEB/wQCMAAwHQYDVR0OBBYEFOtzJRdnpoAEOTDVXYku2ZtQUT8iMB8GA1Ud
IwQYMBaAFPxG0QFDX7t7pj0waK4RuuC8bcnTMF0GCCsGAQUFBwEBBFEwTzAlBggr
BgEFBQcwAYYZaHR0cDovL3N0Zy1lNS5vLmxlbmNyLm9yZzAmBggrBgEFBQcwAoYa
aHR0cDovL3N0Zy1lNS5pLmxlbmNyLm9yZy8wIwYDVR0RBBwwGoIJc3NsLmJvYXRz
gg13d3cuc3NsLmJvYXRzMBMGA1UdIAQMMAowCAYGZ4EMAQIBMIIBCwYKKwYBBAHW
eQIEAgSB/ASB+QD3AHUAsMyD5aX5fWuvfAnMKEkEhyrH6IsTLGNQt8b9JuFsbHcA
AAGTvyMQHgAABAMARjBEAiBX2nYGN2VtVboAuZwpgTisVd49y6ZHxXX/F96BXMJT
CQIgKg4f6fiNdWWHzy9sq2fNcc2p0+oggAoDfHEY5EmUqkYAfgCVkL2F8s/FBkmY
q6tbsmwuehdnApEcE7aLSAXh65Qn7wAAAZO/Ixn7AAgAAAUANFE48wQDAEcwRQIg
I8s4151aDqUSleP2Sz4DrpHbiUm754BnsX32Ut7SoS0CIQCzLvUGsk+OYE/vElMc
XqmSAMEX2DlIYkaKQZloDGxYTzAKBggqhkjOPQQDAwNpADBmAjEA1qGVHDX+Y+G8
ce24WmB32hagTDXU+VbqjvfgjTYteL12ck23wcZ1Rw6rybXgSjCrAjEAw4fgdqE1
m8oGNfIL08TiLJ8c4vjHudCHJEGvSstdl2Ds56klMvl32YFrS7XlEyZQ
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIEljCCAn6gAwIBAgIQRzEp1D1mDiVVv4b1zlB56jANBgkqhkiG9w0BAQsFADBm
MQswCQYDVQQGEwJVUzEzMDEGA1UEChMqKFNUQUdJTkcpIEludGVybmV0IFNlY3Vy
aXR5IFJlc2VhcmNoIEdyb3VwMSIwIAYDVQQDExkoU1RBR0lORykgUHJldGVuZCBQ
ZWFyIFgxMB4XDTI0MDMxMzAwMDAwMFoXDTI3MDMxMjIzNTk1OVowUjELMAkGA1UE
BhMCVVMxIDAeBgNVBAoTFyhTVEFHSU5HKSBMZXQncyBFbmNyeXB0MSEwHwYDVQQD
ExgoU1RBR0lORykgUHNldWRvIFBsdW0gRTUwdjAQBgcqhkjOPQIBBgUrgQQAIgNi
AATljbbcV+mqWZa3g+z0bDOuBpZOtbi48iK9rjLtPdRU0WsgVp53MW3nXFU6qVYV
zEYaYd6PSmec0Tj3R5zEp5/F+cuOjTdh3AkTMzYm1tkflocPBN5APHYZ+76WxZad
q+WjggEAMIH9MA4GA1UdDwEB/wQEAwIBhjAdBgNVHSUEFjAUBggrBgEFBQcDAgYI
KwYBBQUHAwEwEgYDVR0TAQH/BAgwBgEB/wIBADAdBgNVHQ4EFgQU/EbRAUNfu3um
PTBorhG64LxtydMwHwYDVR0jBBgwFoAUtfNl8v6wCpIf+zx980SgrGMlwxQwNgYI
KwYBBQUHAQEEKjAoMCYGCCsGAQUFBzAChhpodHRwOi8vc3RnLXgxLmkubGVuY3Iu
b3JnLzATBgNVHSAEDDAKMAgGBmeBDAECATArBgNVHR8EJDAiMCCgHqAchhpodHRw
Oi8vc3RnLXgxLmMubGVuY3Iub3JnLzANBgkqhkiG9w0BAQsFAAOCAgEAAtCGn4iG
cupruhkCTcoDqSIVTFgVR8JJ3GvGL7SYwIc4Fn0As66nQgnkATIzF5+gFb+CXEQD
qR2Jo+R38OeT7lQ1rNDcaJcbY6hL8cNRku3QlcfdYODZ5pgTVH04gTZUJISZKLjD
kMMcQIDZlF7iYqTvmHbn2ISSKorsJ3QKAvWhHwMoJtocSz3VeDJIep5QtbHnoXh1
/dyDx7sp8RuhC0eO9ElTgDtiA2V6JxigLPzqcnibBBR4bFLGtMNE4EvOOD/Fkd0L
hdGDbAMNd+O06n+b0rgmDvg75IgOV6fpDrdZFoiNfCckOEJh9v10uYt4pTc3B6lf
zI/X3EWP1H4VJmsYuy+OA29jPeP831sAObZtd3RWv0LQPrMfx6FCmy4AaeYEMvul
FrF6OX+JbssE+bn83F+sGEMZu/eVBwwKh3db7+2UduMdTOb8DePE3Aqlg9zofS8X
9fJXrrp+PPrdQyvM3e8DxuioWa9GLG30yD9WD6WTlSiiOrdWGOzisWpW4shFoL8u
0EfmeLVU4JVbauhOYZASQXABNeXewe9lqJWwfqaARYpRjyf+jRibn22H5NVK4Vog
l55Iq1rUgjc8r493NaNrlNwG7va7Ztkch5lJ3oL/FEVlVSK4snTbgb0b5qjQz3SA
i7rA/8QRZvOLnKNtdEUlDZNrzkZwHNluLGw=
-----END CERTIFICATE-----`;

let buffer1 = asn1.pemToBuffer(cert2);

let aki1 = asn1.decodeAKI(buffer1);

let serial1 = asn1.decodeSerialNumber(buffer1);

console.log(aki1 === "fc46d101435fbb7ba63d3068ae11bae0bc6dc9d3", serial1 === "2b5aef52d26159138cbe398f5f5d16a1b6bd");

let cert = `-----BEGIN CERTIFICATE-----
MIIC3zCCAcegAwIBAgIFAIdlQyEwDQYJKoZIhvcNAQELBQAwFTETMBEGA1UEAwwK
RXhhbXBsZSBDQTAeFw01MDAxMDEwMDAwMDBaFw01MDAxMDEwMDAwMDBaMBYxFDAS
BgNVBAMMC2V4YW1wbGUuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC
AQEAy3VnrpBZT8VcByJKAu4zIrAVu14cRlipEuQMHSe9Psa7vvXzoJQD6Uc4/mwz
o7m+3yaRM8eSQWSc4AraBfqkRfSNP+wwygVqfbHcWOe9/v3uai1IfCKT+WryszP3
ahN/ceMqRc1axukk7bO5KeLlj4/wUGgq+zYhAF4ZJcolwwD4M8qUTgplKWLzhpZz
BbJlvQCi2sAkQDH0d7hice56BBY2X7d35T65MAeeVKFxXOWN59HMgitLCDK0E9Mf
GJJHriSB3iW39zNiasyTupZFhrNS8G/5NGd0oqAlkkj/Jb7cX9w0RfCJw5sEfpL6
lDtqgF0VyfRhSYdEzYAMoSaeGwIDAQABozUwMzAxBgNVHSMEKjAogBRpiFtrh0ZA
QeGze4R7oK4s3gHI1KENhgtFWEFNUExFLkNPTYIBATANBgkqhkiG9w0BAQsFAAOC
AQEAchL9etTHAaaJ1h1xqbIR7dL7QcHodSL8tGgsWww0/g+XqcRy/Y9TJV1zLhJs
UnrPC7mWRGsn+aTD/VBJwd+K6i7gbQ5WDvY+AClFUTJNtwOxT+hZxm0KdkWXfRJc
ciejEynaxypoZy4i73uM9inPea8mDKwdOD3ZTDAJqVCBGyJN1BRqVCte8aWNA/ls
htw6KK8Uusn6mGBuEw+dYHhN/T+1ouKiYYYAoeDU7wq+qKdNb1wcBeQGOCro2C9K
4izzQ1FXpYc+wh8MceTtYDIrI+Wszhwb/S/1K5uD1sJ9F033gzNj8e61dMQtdPr9
xcE1fgyXJnOFsRliMCw6R7IsDA==
-----END CERTIFICATE-----`;

let buffer = asn1.pemToBuffer(cert);

let aki = asn1.decodeAKI(buffer);

let serial = asn1.decodeSerialNumber(buffer);

console.log(serial === "0087654321", aki === "69885b6b87464041e1b37b847ba0ae2cde01c8d4", aki.includes("69885b6b87464041e1b37b847ba0ae2cde01c8d4"));

console.log("");